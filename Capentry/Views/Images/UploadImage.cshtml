@model Capentry.ViewModels.ImageViewModel

@{
    ViewBag.Title = "Upload";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<link href="~/Content/CSS/Images.css" rel="stylesheet" type="text/css" />

<div class="row flex-row justify-content-center align-items-center" id="Upload">
    <div class="col-4">
        <h2>Upload</h2>

        @using (Html.BeginForm("UploadImage", "Images", FormMethod.Post, new { enctype = "multipart/form-data", }))
        {
            @Html.AntiForgeryToken()

            <div class="form-horizontal">
                <h4>Image</h4>
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <div class="mb-3">
                    @Html.Label("Image", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(model => model.Files, new { type = "file", @class = "form-control", id="file", onchange= "readURL(this)" })
                        @Html.ValidationMessage("Please Select Photo")
                    </div>
                </div>

                <div class="mb-3">
                    @Html.Label("Project", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-10">
                        @Html.DropDownListFor(model => model.ProjectID, (SelectList)ViewBag.Projects,
                                "Select", new { @class = "form-select rounded-0" })
                        @Html.ValidationMessage("Please Select Photo")
                    </div>
                </div>

                <div class="mb-3">
                    <div class="col-md-10">
                        <button class="btn btn-dark bi bi-upload" type="submit" value="Submit">  Upload</button>
                    </div>
                </div>
            </div>
        }

        <div>
            @Html.ActionLink("Back to List", "Index")
        </div>
    </div>
    <div class="col-5 d-flex align-items-center" id="previewColumn">
        <img class="img-fluid img" src="~/Content/Images/background.jpg" alt="preview" id="preview"/>
    </div>
</div>

<script type="text/javascript">
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#preview')
                    .attr('src', e.target.result);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
</script>